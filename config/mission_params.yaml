# Nidar Mission Parameters
# Configuration for dual-drone survey and delivery mission

# Flight Parameters
flight:
  survey:
    cruise_altitude: 20.0        # meters - Drone 1 survey altitude
    cruise_speed: 5.0            # m/s
    loiter_radius: 10.0          # meters
  delivery:
    cruise_altitude: 15.0        # meters - Drone 2 delivery altitude
    cruise_speed: 7.0            # m/s
    approach_speed: 3.0          # m/s - slow approach to target
    hold_altitude: 25.0          # meters - loiter altitude when idle

# Path Planning
path_planning:
  sweep_spacing: 7.0             # meters between sweep lines
  waypoint_interval: 10.0        # meters between waypoints
  overlap_percentage: 30         # camera overlap percentage

# Detection Parameters
detection:
  model_path: "best_model/dj_yolo_best/weights/best.pt"  # Relative to project root
  confidence_threshold: 0.70     # minimum confidence for detection
  nms_threshold: 0.45            # non-max suppression threshold
  target_class_id: 0             # class ID for 'person'
  frame_skip: 2                  # process every Nth frame for performance

# Tracking Parameters (BoT-SORT)
tracking:
  enabled: true                  # Enable tracking mode
  tracker_type: "botsort"        # Tracker type
  track_high_thresh: 0.5         # High confidence detection threshold
  track_low_thresh: 0.1          # Low confidence for second association
  new_track_thresh: 0.7          # Threshold for creating new tracks
  track_buffer: 90               # Frames to keep lost tracks (1.5s at 60fps)
  match_thresh: 0.7              # Matching threshold for association
  with_reid: true                # Enable Re-ID appearance matching
  counting_box_ratio: 0.9        # Counting zone size (percentage of frame)

# Payload Configuration
payload:
  initial_count: 10              # number of payloads loaded
  drop_altitude: 10.0            # meters above ground for drop
  drop_stabilize_time: 2.0       # seconds to stabilize before drop
  
  # ESP32 + PCA9685 Configuration
  use_esp32: true                # true = ESP32, false = MAVLink servo
  esp32_serial_port: "/dev/ttyUSB0"  # Serial port for ESP32
  esp32_baud_rate: 115200        # Serial baud rate
  
  # MAVLink Servo (if use_esp32: false)
  servo_channel: 9               # MAVLink servo channel
  servo_drop_pwm: 2000           # PWM value to trigger drop
  servo_hold_pwm: 1000           # PWM value to hold payload

# Safety Parameters
safety:
  min_battery_voltage: 14.0      # volts - trigger RTL below this
  min_battery_percent: 20        # percent - trigger RTL below this
  max_distance_from_home: 500    # meters - geofence radius
  failsafe_rtl_altitude: 30.0    # meters - RTL altitude
  connection_timeout: 5.0        # seconds - max time without heartbeat
  gps_fix_required: true         # require 3D fix before takeoff

# Camera/Video Stream
camera:
  rtsp_url: "rtsp://192.168.144.25:8554/main.264"
  frame_width: 1920
  frame_height: 1080
  reconnect_delay: 2.0           # seconds before reconnect attempt
  # Geotagging calibration (for GSD-based coordinate calculation)
  sensor_width_mm: 7.6           # Horizontal sensor size in mm
  focal_length_mm: 4.4           # Camera focal length in mm
  gimbal_pitch_deg: 90           # 90 = nadir (straight down), 0 = horizontal

# Logging
logging:
  level: "INFO"                  # DEBUG, INFO, WARNING, ERROR
  save_detections: true          # save detection snapshots
  detection_image_quality: 85    # JPEG quality (0-100)
